CREATE OR REPLACE PROCEDURE Accept_claims(json_input STRING)
RETURNS VARCHAR
LANGUAGE SQL
AS
$$
DECLARE
  ceid VARCHAR;
  client_id VARCHAR;
  user_name VARCHAR;
  comment VARCHAR;
BEGIN
  -- Process Root1
  SELECT 
    f.value:CEID::VARCHAR,
    f.value:CLIENT_ID::VARCHAR,
    f.value:USER_NAME::VARCHAR,
    f.value:COMMENT::VARCHAR
  INTO :ceid, :client_id, :user_name, :comment
  FROM TABLE(FLATTEN(input => PARSE_JSON(json_input):Root1)) f;

  -- Example of further processing or inserting into a table
  INSERT INTO claims_table (ceid, client_id, user_name, comment)
  VALUES (:ceid, :client_id, :user_name, :comment);

  -- Repeat for Root2 and Root3 or handle dynamically as required
  RETURN 'Claims processed successfully';
END;
$$;
