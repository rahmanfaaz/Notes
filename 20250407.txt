#!/bin/bash
# ================================================================
# Git commit-msg hook to enforce JIRA ID format (e.g., AC-234567)
# ================================================================

commit_msg_file="$1"
commit_msg=$(cat "$commit_msg_file")

# Allow multiple prefixes (AC, TO, BUG, ICR, DEPO, etc.)
jira_pattern='\b(AC|TO|BUG|ICR|DEPO)-[0-9]{3,6}\b'

# Skip enforcement for merge commits or version bumps
if echo "$commit_msg" | grep -Eq "^Merge branch|^Merge pull request|Bump version"; then
  exit 0
fi

# Validate commit message
if ! echo "$commit_msg" | grep -Eq "$jira_pattern"; then
  echo -e "\033[1;31m‚ùå ERROR:\033[0m Commit message must include a valid JIRA ID (e.g., AC-234567)" >&2
  echo -e "\033[1;33müí° Example:\033[0m  AC-234567 | Added Claims Validation for HSBC" >&2
  exit 1
fi

exit 0


#!/bin/bash
# ================================================================
# Git post-checkout hook ‚Äî Auto-activates JIRA enforcement hooks
# ================================================================

# Enforce hooks path
git config core.hooksPath .githooks

echo -e "\033[1;34mü™ù Git hooks path set to .githooks (auto-enforced)\033[0m"
echo -e "\033[1;33m‚ö†Ô∏è  Reminder:\033[0m All commit messages must include a valid JIRA ID (e.g., AC-234567)"


#!/bin/bash
# ================================================================
# Git post-merge hook ‚Äî Re-applies JIRA hook enforcement
# ================================================================

# Reapply hook path after pull/merge
git config core.hooksPath .githooks

echo -e "\033[1;32müîÅ Hooks re-activated after merge/pull.\033[0m"
echo -e "\033[1;33m‚ö†Ô∏è  Reminder:\033[0m Commit messages must include JIRA ID (e.g., AC-234567)"
