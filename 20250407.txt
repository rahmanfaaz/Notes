CREATE OR REPLACE PROCEDURE SFDB_D_ICR_DEP_DW.ODS_DEP_DW.TEST_PER_CEID_DETAILS(
    INPUT_PAYLOAD VARIANT
)
RETURNS TABLE (CEID STRING, USER_NAME STRING, COMMENT STRING, CLIENT_ID STRING)
LANGUAGE SQL
AS
$$
    SELECT
        VALUE:CEID::STRING AS CEID,
        VALUE:USER_NAME::STRING AS USER_NAME,
        COALESCE(VALUE:COMMENT::STRING, 'Accepted by batch') AS COMMENT,
        VALUE:CLIENT_ID::STRING AS CLIENT_ID
    FROM TABLE(FLATTEN(INPUT => INPUT_PAYLOAD));
$$;
